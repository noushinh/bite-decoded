{"ast":null,"code":"var _jsxFileName = \"/Users/noushinhaque/foodies/src/components/Map.js\",\n  _s = $RefreshSig$();\nimport React, { useRef, useEffect } from 'react';\nimport L from 'leaflet';\nimport 'leaflet/dist/leaflet.css';\n\n// (No dynamic loaders needed — Leaflet is imported from npm)\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport default function Map({\n  locations = [],\n  selectedLocation = null\n}) {\n  _s();\n  const mapContainer = useRef(null);\n  const mapRef = useRef(null);\n  const markersRef = useRef([]);\n  useEffect(() => {\n    let cancelled = false;\n    let tries = 0;\n    const initLeaflet = () => {\n      if (cancelled) return;\n      const container = mapContainer.current;\n      if (!container) {\n        if (tries++ < 20) return setTimeout(initLeaflet, 100);\n        // eslint-disable-next-line no-console\n        console.warn('Leaflet: map container not found after retries');\n        return;\n      }\n      const {\n        clientWidth,\n        clientHeight\n      } = container;\n      if (!clientWidth || !clientHeight) {\n        if (tries++ < 20) return setTimeout(initLeaflet, 100);\n        // eslint-disable-next-line no-console\n        console.warn('Leaflet: map container has zero size after retries', clientWidth, clientHeight);\n        // we'll proceed anyway\n      }\n      try {\n        const map = L.map(container, {\n          scrollWheelZoom: true\n        }).setView([20, 0], 2);\n        L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {\n          maxZoom: 19,\n          attribution: '&copy; <a href=\"https://www.openstreetmap.org/\">OpenStreetMap</a> contributors'\n        }).addTo(map);\n        mapRef.current = map;\n        try {\n          L.control.scale({\n            position: 'bottomleft',\n            imperial: false\n          }).addTo(map);\n        } catch (e) {}\n        const ensureSize = () => {\n          try {\n            map.invalidateSize && map.invalidateSize();\n          } catch (e) {}\n        };\n        ensureSize();\n        const _t1 = setTimeout(ensureSize, 100);\n        const _t2 = setTimeout(ensureSize, 500);\n        const _t3 = setTimeout(ensureSize, 1000);\n        const _t4 = setTimeout(ensureSize, 2000);\n        const _t5 = setTimeout(ensureSize, 4000);\n        const onResize = () => ensureSize();\n        window.addEventListener('resize', onResize);\n\n        // eslint-disable-next-line no-console\n        console.log('Leaflet initialized', {\n          clientWidth,\n          clientHeight\n        });\n        try {\n          if (typeof window !== 'undefined') window.__LEAFLET_MAP__ = map;\n        } catch (e) {}\n        return () => {\n          try {\n            window.removeEventListener('resize', onResize);\n          } catch (e) {}\n          clearTimeout(_t1);\n          clearTimeout(_t2);\n          clearTimeout(_t3);\n          clearTimeout(_t4);\n          clearTimeout(_t5);\n          try {\n            map.remove();\n          } catch (e) {}\n          mapRef.current = null;\n        };\n      } catch (e) {\n        // eslint-disable-next-line no-console\n        console.warn('Leaflet init failed:', e);\n      }\n    };\n    initLeaflet();\n    return () => {\n      cancelled = true;\n    };\n  }, []);\n\n  // Update markers (Leaflet)\n  useEffect(() => {\n    const map = mapRef.current;\n    if (!map) return;\n\n    // remove existing marker layers\n    markersRef.current.forEach(m => {\n      try {\n        map.removeLayer(m);\n      } catch (e) {}\n    });\n    markersRef.current = [];\n    locations.forEach(loc => {\n      try {\n        const m = L.circleMarker([loc.coordinates[1], loc.coordinates[0]], {\n          radius: 6,\n          color: '#2a9df4',\n          fillOpacity: 0.9\n        }).addTo(map);\n        m.bindPopup(`<strong>${loc.title}</strong><br/>${loc.description}`);\n        markersRef.current.push(m);\n      } catch (e) {\n        // ignore\n      }\n    });\n\n    // if we added any markers, fit the map to their bounds for a good initial view\n    try {\n      if (markersRef.current.length > 0) {\n        const group = L.featureGroup(markersRef.current);\n        map.fitBounds(group.getBounds().pad(0.25), {\n          animate: true\n        });\n      } else {\n        // no markers: show a world view\n        map.setView([20, 0], 2);\n      }\n    } catch (e) {/* ignore fit errors */}\n  }, [locations]);\n\n  // Handle selection: open popup and set view\n  useEffect(() => {\n    if (!selectedLocation) return;\n    const map = mapRef.current;\n    if (!map) return;\n    const [lng, lat] = selectedLocation.coordinates;\n    map.setView([lat, lng], 14);\n    const matched = markersRef.current.find(m => {\n      try {\n        const latlng = m.getLatLng();\n        return Math.abs(latlng.lng - lng) < 1e-6 && Math.abs(latlng.lat - lat) < 1e-6;\n      } catch (e) {\n        return false;\n      }\n    });\n    if (matched && matched.openPopup) matched.openPopup();\n  }, [selectedLocation]);\n  return (\n    /*#__PURE__*/\n    // Render the map container as the direct child so flex sizing rules apply\n    _jsxDEV(\"div\", {\n      ref: mapContainer,\n      id: \"map\",\n      className: \"map\",\n      style: {\n        flex: 1,\n        height: '100%',\n        minHeight: 320\n      }\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 122,\n      columnNumber: 5\n    }, this)\n  );\n}\n_s(Map, \"0QljtO8RzWhlkrJOIuZ6SHs7slk=\");\n_c = Map;\nvar _c;\n$RefreshReg$(_c, \"Map\");","map":{"version":3,"names":["React","useRef","useEffect","L","jsxDEV","_jsxDEV","Map","locations","selectedLocation","_s","mapContainer","mapRef","markersRef","cancelled","tries","initLeaflet","container","current","setTimeout","console","warn","clientWidth","clientHeight","map","scrollWheelZoom","setView","tileLayer","maxZoom","attribution","addTo","control","scale","position","imperial","e","ensureSize","invalidateSize","_t1","_t2","_t3","_t4","_t5","onResize","window","addEventListener","log","__LEAFLET_MAP__","removeEventListener","clearTimeout","remove","forEach","m","removeLayer","loc","circleMarker","coordinates","radius","color","fillOpacity","bindPopup","title","description","push","length","group","featureGroup","fitBounds","getBounds","pad","animate","lng","lat","matched","find","latlng","getLatLng","Math","abs","openPopup","ref","id","className","style","flex","height","minHeight","fileName","_jsxFileName","lineNumber","columnNumber","_c","$RefreshReg$"],"sources":["/Users/noushinhaque/foodies/src/components/Map.js"],"sourcesContent":["import React, { useRef, useEffect } from 'react';\nimport L from 'leaflet';\nimport 'leaflet/dist/leaflet.css';\n\n// (No dynamic loaders needed — Leaflet is imported from npm)\n\nexport default function Map({ locations = [], selectedLocation = null }) {\n  const mapContainer = useRef(null);\n  const mapRef = useRef(null);\n  const markersRef = useRef([]);\n\n    useEffect(() => {\n      let cancelled = false;\n      let tries = 0;\n\n      const initLeaflet = () => {\n        if (cancelled) return;\n        const container = mapContainer.current;\n        if (!container) {\n          if (tries++ < 20) return setTimeout(initLeaflet, 100);\n          // eslint-disable-next-line no-console\n          console.warn('Leaflet: map container not found after retries');\n          return;\n        }\n\n        const { clientWidth, clientHeight } = container;\n        if (!clientWidth || !clientHeight) {\n          if (tries++ < 20) return setTimeout(initLeaflet, 100);\n          // eslint-disable-next-line no-console\n          console.warn('Leaflet: map container has zero size after retries', clientWidth, clientHeight);\n          // we'll proceed anyway\n        }\n\n        try {\n          const map = L.map(container, { scrollWheelZoom: true }).setView([20, 0], 2);\n          L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {\n            maxZoom: 19,\n            attribution: '&copy; <a href=\"https://www.openstreetmap.org/\">OpenStreetMap</a> contributors',\n          }).addTo(map);\n\n          mapRef.current = map;\n\n          try { L.control.scale({ position: 'bottomleft', imperial: false }).addTo(map); } catch (e) {}\n\n          const ensureSize = () => { try { map.invalidateSize && map.invalidateSize(); } catch (e) {} };\n          ensureSize();\n          const _t1 = setTimeout(ensureSize, 100);\n          const _t2 = setTimeout(ensureSize, 500);\n          const _t3 = setTimeout(ensureSize, 1000);\n          const _t4 = setTimeout(ensureSize, 2000);\n          const _t5 = setTimeout(ensureSize, 4000);\n          const onResize = () => ensureSize();\n          window.addEventListener('resize', onResize);\n\n          // eslint-disable-next-line no-console\n          console.log('Leaflet initialized', { clientWidth, clientHeight });\n          try { if (typeof window !== 'undefined') window.__LEAFLET_MAP__ = map; } catch(e){}\n\n          return () => {\n            try { window.removeEventListener('resize', onResize); } catch (e) {}\n            clearTimeout(_t1); clearTimeout(_t2); clearTimeout(_t3); clearTimeout(_t4); clearTimeout(_t5);\n            try { map.remove(); } catch (e) {}\n            mapRef.current = null;\n          };\n        } catch (e) {\n          // eslint-disable-next-line no-console\n          console.warn('Leaflet init failed:', e);\n        }\n      };\n\n      initLeaflet();\n\n      return () => { cancelled = true; };\n    }, []);\n\n  // Update markers (Leaflet)\n  useEffect(() => {\n    const map = mapRef.current;\n    if (!map) return;\n\n    // remove existing marker layers\n    markersRef.current.forEach((m) => { try { map.removeLayer(m); } catch(e) {} });\n    markersRef.current = [];\n\n    locations.forEach((loc) => {\n      try {\n        const m = L.circleMarker([loc.coordinates[1], loc.coordinates[0]], { radius: 6, color: '#2a9df4', fillOpacity: 0.9 }).addTo(map);\n        m.bindPopup(`<strong>${loc.title}</strong><br/>${loc.description}`);\n        markersRef.current.push(m);\n      } catch (e) {\n        // ignore\n      }\n    });\n\n    // if we added any markers, fit the map to their bounds for a good initial view\n    try {\n      if (markersRef.current.length > 0) {\n        const group = L.featureGroup(markersRef.current);\n        map.fitBounds(group.getBounds().pad(0.25), { animate: true });\n      } else {\n        // no markers: show a world view\n        map.setView([20, 0], 2);\n      }\n    } catch (e) { /* ignore fit errors */ }\n  }, [locations]);\n\n  // Handle selection: open popup and set view\n  useEffect(() => {\n    if (!selectedLocation) return;\n    const map = mapRef.current;\n    if (!map) return;\n    const [lng, lat] = selectedLocation.coordinates;\n    map.setView([lat, lng], 14);\n    const matched = markersRef.current.find((m) => {\n      try { const latlng = m.getLatLng(); return Math.abs(latlng.lng - lng) < 1e-6 && Math.abs(latlng.lat - lat) < 1e-6; } catch(e) { return false; }\n    });\n    if (matched && matched.openPopup) matched.openPopup();\n  }, [selectedLocation]);\n\n  return (\n    // Render the map container as the direct child so flex sizing rules apply\n    <div\n      ref={mapContainer}\n      id=\"map\"\n      className=\"map\"\n      style={{ flex: 1, height: '100%', minHeight: 320 }}\n    />\n  );\n}\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}