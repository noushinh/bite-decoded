{"ast":null,"code":"import React,{useRef,useEffect}from'react';import mapboxgl from'mapbox-gl';import'mapbox-gl/dist/mapbox-gl.css';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";export default function Map(_ref){let{locations=[],selectedLocation=null}=_ref;const mapContainer=useRef(null);const mapRef=useRef(null);const markersRef=useRef([]);useEffect(()=>{const token=process.env.REACT_APP_MAPBOX_TOKEN||window.__MAPBOX_TOKEN__;if(!token){// eslint-disable-next-line no-console\nconsole.warn('Mapbox token missing (REACT_APP_MAPBOX_TOKEN or window.__MAPBOX_TOKEN__). Map will not initialize.');return;}mapboxgl.accessToken=token;const map=new mapboxgl.Map({container:mapContainer.current,style:'mapbox://styles/mapbox/streets-v11',center:[-74.006,40.7128],zoom:12});map.addControl(new mapboxgl.NavigationControl());mapRef.current=map;return()=>{map.remove();mapRef.current=null;};},[]);// Update markers whenever locations change\nuseEffect(()=>{const map=mapRef.current;if(!map)return;// Remove existing markers\nmarkersRef.current.forEach(m=>m.remove());markersRef.current=[];locations.forEach(loc=>{const marker=new mapboxgl.Marker().setLngLat(loc.coordinates).setPopup(new mapboxgl.Popup({offset:12}).setHTML(\"<strong>\".concat(loc.title,\"</strong><p>\").concat(loc.description,\"</p>\"))).addTo(map);markersRef.current.push(marker);});},[locations]);// When selectedLocation changes, fly to it and open its popup\nuseEffect(()=>{const map=mapRef.current;if(!map||!selectedLocation)return;const[lng,lat]=selectedLocation.coordinates;map.flyTo({center:[lng,lat],zoom:14});// Open popup for matching marker\nconst matched=markersRef.current.find(m=>{const lngLat=m.getLngLat();return Math.abs(lngLat.lng-lng)<1e-6&&Math.abs(lngLat.lat-lat)<1e-6;});if(matched)matched.togglePopup();},[selectedLocation]);return/*#__PURE__*/_jsxs(\"div\",{style:{position:'relative',height:'100%'},children:[/*#__PURE__*/_jsx(\"div\",{ref:mapContainer,id:\"map\",className:\"map\",style:{height:'100%'}}),!process.env.REACT_APP_MAPBOX_TOKEN&&!window.__MAPBOX_TOKEN__&&/*#__PURE__*/_jsxs(\"div\",{style:{position:'absolute',top:80,left:16,background:'rgba(255,255,255,0.95)',padding:10,borderRadius:6,zIndex:2},children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Mapbox token missing\"}),/*#__PURE__*/_jsx(\"div\",{style:{fontSize:13,marginTop:6},children:\"Provide `REACT_APP_MAPBOX_TOKEN` at build time or set `window.__MAPBOX_TOKEN__` in `public/index.html`.\"})]})]});}","map":{"version":3,"names":["React","useRef","useEffect","mapboxgl","jsx","_jsx","jsxs","_jsxs","Map","_ref","locations","selectedLocation","mapContainer","mapRef","markersRef","token","process","env","REACT_APP_MAPBOX_TOKEN","window","__MAPBOX_TOKEN__","console","warn","accessToken","map","container","current","style","center","zoom","addControl","NavigationControl","remove","forEach","m","loc","marker","Marker","setLngLat","coordinates","setPopup","Popup","offset","setHTML","concat","title","description","addTo","push","lng","lat","flyTo","matched","find","lngLat","getLngLat","Math","abs","togglePopup","position","height","children","ref","id","className","top","left","background","padding","borderRadius","zIndex","fontSize","marginTop"],"sources":["/Users/noushinhaque/foodies/src/components/Map.js"],"sourcesContent":["import React, { useRef, useEffect } from 'react';\nimport mapboxgl from 'mapbox-gl';\nimport 'mapbox-gl/dist/mapbox-gl.css';\n\nexport default function Map({ locations = [], selectedLocation = null }) {\n  const mapContainer = useRef(null);\n  const mapRef = useRef(null);\n  const markersRef = useRef([]);\n\n  useEffect(() => {\n    const token = process.env.REACT_APP_MAPBOX_TOKEN || window.__MAPBOX_TOKEN__;\n    if (!token) {\n      // eslint-disable-next-line no-console\n      console.warn('Mapbox token missing (REACT_APP_MAPBOX_TOKEN or window.__MAPBOX_TOKEN__). Map will not initialize.');\n      return;\n    }\n\n    mapboxgl.accessToken = token;\n\n    const map = new mapboxgl.Map({\n      container: mapContainer.current,\n      style: 'mapbox://styles/mapbox/streets-v11',\n      center: [-74.006, 40.7128],\n      zoom: 12,\n    });\n\n    map.addControl(new mapboxgl.NavigationControl());\n\n    mapRef.current = map;\n\n    return () => {\n      map.remove();\n      mapRef.current = null;\n    };\n  }, []);\n\n  // Update markers whenever locations change\n  useEffect(() => {\n    const map = mapRef.current;\n    if (!map) return;\n\n    // Remove existing markers\n    markersRef.current.forEach((m) => m.remove());\n    markersRef.current = [];\n\n    locations.forEach((loc) => {\n      const marker = new mapboxgl.Marker()\n        .setLngLat(loc.coordinates)\n        .setPopup(new mapboxgl.Popup({ offset: 12 }).setHTML(`<strong>${loc.title}</strong><p>${loc.description}</p>`))\n        .addTo(map);\n\n      markersRef.current.push(marker);\n    });\n  }, [locations]);\n\n  // When selectedLocation changes, fly to it and open its popup\n  useEffect(() => {\n    const map = mapRef.current;\n    if (!map || !selectedLocation) return;\n\n    const [lng, lat] = selectedLocation.coordinates;\n    map.flyTo({ center: [lng, lat], zoom: 14 });\n\n    // Open popup for matching marker\n    const matched = markersRef.current.find((m) => {\n      const lngLat = m.getLngLat();\n      return Math.abs(lngLat.lng - lng) < 1e-6 && Math.abs(lngLat.lat - lat) < 1e-6;\n    });\n    if (matched) matched.togglePopup();\n  }, [selectedLocation]);\n\n  return (\n    <div style={{ position: 'relative', height: '100%' }}>\n      <div ref={mapContainer} id=\"map\" className=\"map\" style={{ height: '100%' }} />\n      {/* If token missing, show a non-blocking overlay message */}\n      {!process.env.REACT_APP_MAPBOX_TOKEN && !window.__MAPBOX_TOKEN__ && (\n        <div style={{ position: 'absolute', top: 80, left: 16, background: 'rgba(255,255,255,0.95)', padding: 10, borderRadius: 6, zIndex: 2 }}>\n          <strong>Mapbox token missing</strong>\n          <div style={{ fontSize: 13, marginTop: 6 }}>\n            Provide `REACT_APP_MAPBOX_TOKEN` at build time or set `window.__MAPBOX_TOKEN__` in `public/index.html`.\n          </div>\n        </div>\n      )}\n    </div>\n  );\n}\n"],"mappings":"AAAA,MAAO,CAAAA,KAAK,EAAIC,MAAM,CAAEC,SAAS,KAAQ,OAAO,CAChD,MAAO,CAAAC,QAAQ,KAAM,WAAW,CAChC,MAAO,8BAA8B,CAAC,OAAAC,GAAA,IAAAC,IAAA,CAAAC,IAAA,IAAAC,KAAA,yBAEtC,cAAe,SAAS,CAAAC,GAAGA,CAAAC,IAAA,CAA8C,IAA7C,CAAEC,SAAS,CAAG,EAAE,CAAEC,gBAAgB,CAAG,IAAK,CAAC,CAAAF,IAAA,CACrE,KAAM,CAAAG,YAAY,CAAGX,MAAM,CAAC,IAAI,CAAC,CACjC,KAAM,CAAAY,MAAM,CAAGZ,MAAM,CAAC,IAAI,CAAC,CAC3B,KAAM,CAAAa,UAAU,CAAGb,MAAM,CAAC,EAAE,CAAC,CAE7BC,SAAS,CAAC,IAAM,CACd,KAAM,CAAAa,KAAK,CAAGC,OAAO,CAACC,GAAG,CAACC,sBAAsB,EAAIC,MAAM,CAACC,gBAAgB,CAC3E,GAAI,CAACL,KAAK,CAAE,CACV;AACAM,OAAO,CAACC,IAAI,CAAC,oGAAoG,CAAC,CAClH,OACF,CAEAnB,QAAQ,CAACoB,WAAW,CAAGR,KAAK,CAE5B,KAAM,CAAAS,GAAG,CAAG,GAAI,CAAArB,QAAQ,CAACK,GAAG,CAAC,CAC3BiB,SAAS,CAAEb,YAAY,CAACc,OAAO,CAC/BC,KAAK,CAAE,oCAAoC,CAC3CC,MAAM,CAAE,CAAC,CAAC,MAAM,CAAE,OAAO,CAAC,CAC1BC,IAAI,CAAE,EACR,CAAC,CAAC,CAEFL,GAAG,CAACM,UAAU,CAAC,GAAI,CAAA3B,QAAQ,CAAC4B,iBAAiB,CAAC,CAAC,CAAC,CAEhDlB,MAAM,CAACa,OAAO,CAAGF,GAAG,CAEpB,MAAO,IAAM,CACXA,GAAG,CAACQ,MAAM,CAAC,CAAC,CACZnB,MAAM,CAACa,OAAO,CAAG,IAAI,CACvB,CAAC,CACH,CAAC,CAAE,EAAE,CAAC,CAEN;AACAxB,SAAS,CAAC,IAAM,CACd,KAAM,CAAAsB,GAAG,CAAGX,MAAM,CAACa,OAAO,CAC1B,GAAI,CAACF,GAAG,CAAE,OAEV;AACAV,UAAU,CAACY,OAAO,CAACO,OAAO,CAAEC,CAAC,EAAKA,CAAC,CAACF,MAAM,CAAC,CAAC,CAAC,CAC7ClB,UAAU,CAACY,OAAO,CAAG,EAAE,CAEvBhB,SAAS,CAACuB,OAAO,CAAEE,GAAG,EAAK,CACzB,KAAM,CAAAC,MAAM,CAAG,GAAI,CAAAjC,QAAQ,CAACkC,MAAM,CAAC,CAAC,CACjCC,SAAS,CAACH,GAAG,CAACI,WAAW,CAAC,CAC1BC,QAAQ,CAAC,GAAI,CAAArC,QAAQ,CAACsC,KAAK,CAAC,CAAEC,MAAM,CAAE,EAAG,CAAC,CAAC,CAACC,OAAO,YAAAC,MAAA,CAAYT,GAAG,CAACU,KAAK,iBAAAD,MAAA,CAAeT,GAAG,CAACW,WAAW,QAAM,CAAC,CAAC,CAC9GC,KAAK,CAACvB,GAAG,CAAC,CAEbV,UAAU,CAACY,OAAO,CAACsB,IAAI,CAACZ,MAAM,CAAC,CACjC,CAAC,CAAC,CACJ,CAAC,CAAE,CAAC1B,SAAS,CAAC,CAAC,CAEf;AACAR,SAAS,CAAC,IAAM,CACd,KAAM,CAAAsB,GAAG,CAAGX,MAAM,CAACa,OAAO,CAC1B,GAAI,CAACF,GAAG,EAAI,CAACb,gBAAgB,CAAE,OAE/B,KAAM,CAACsC,GAAG,CAAEC,GAAG,CAAC,CAAGvC,gBAAgB,CAAC4B,WAAW,CAC/Cf,GAAG,CAAC2B,KAAK,CAAC,CAAEvB,MAAM,CAAE,CAACqB,GAAG,CAAEC,GAAG,CAAC,CAAErB,IAAI,CAAE,EAAG,CAAC,CAAC,CAE3C;AACA,KAAM,CAAAuB,OAAO,CAAGtC,UAAU,CAACY,OAAO,CAAC2B,IAAI,CAAEnB,CAAC,EAAK,CAC7C,KAAM,CAAAoB,MAAM,CAAGpB,CAAC,CAACqB,SAAS,CAAC,CAAC,CAC5B,MAAO,CAAAC,IAAI,CAACC,GAAG,CAACH,MAAM,CAACL,GAAG,CAAGA,GAAG,CAAC,CAAG,IAAI,EAAIO,IAAI,CAACC,GAAG,CAACH,MAAM,CAACJ,GAAG,CAAGA,GAAG,CAAC,CAAG,IAAI,CAC/E,CAAC,CAAC,CACF,GAAIE,OAAO,CAAEA,OAAO,CAACM,WAAW,CAAC,CAAC,CACpC,CAAC,CAAE,CAAC/C,gBAAgB,CAAC,CAAC,CAEtB,mBACEJ,KAAA,QAAKoB,KAAK,CAAE,CAAEgC,QAAQ,CAAE,UAAU,CAAEC,MAAM,CAAE,MAAO,CAAE,CAAAC,QAAA,eACnDxD,IAAA,QAAKyD,GAAG,CAAElD,YAAa,CAACmD,EAAE,CAAC,KAAK,CAACC,SAAS,CAAC,KAAK,CAACrC,KAAK,CAAE,CAAEiC,MAAM,CAAE,MAAO,CAAE,CAAE,CAAC,CAE7E,CAAC5C,OAAO,CAACC,GAAG,CAACC,sBAAsB,EAAI,CAACC,MAAM,CAACC,gBAAgB,eAC9Db,KAAA,QAAKoB,KAAK,CAAE,CAAEgC,QAAQ,CAAE,UAAU,CAAEM,GAAG,CAAE,EAAE,CAAEC,IAAI,CAAE,EAAE,CAAEC,UAAU,CAAE,wBAAwB,CAAEC,OAAO,CAAE,EAAE,CAAEC,YAAY,CAAE,CAAC,CAAEC,MAAM,CAAE,CAAE,CAAE,CAAAT,QAAA,eACrIxD,IAAA,WAAAwD,QAAA,CAAQ,sBAAoB,CAAQ,CAAC,cACrCxD,IAAA,QAAKsB,KAAK,CAAE,CAAE4C,QAAQ,CAAE,EAAE,CAAEC,SAAS,CAAE,CAAE,CAAE,CAAAX,QAAA,CAAC,yGAE5C,CAAK,CAAC,EACH,CACN,EACE,CAAC,CAEV","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}