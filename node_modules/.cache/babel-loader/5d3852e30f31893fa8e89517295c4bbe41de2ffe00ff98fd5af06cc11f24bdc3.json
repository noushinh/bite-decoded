{"ast":null,"code":"var _jsxFileName = \"/Users/noushinhaque/foodies/src/components/Map.js\",\n  _s = $RefreshSig$();\nimport React, { useRef, useEffect } from 'react';\nimport L from 'leaflet';\nimport 'leaflet/dist/leaflet.css';\n\n// (No dynamic loaders needed — Leaflet is imported from npm)\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport default function Map({\n  locations = [],\n  selectedLocation = null\n}) {\n  _s();\n  const mapContainer = useRef(null);\n  const mapRef = useRef(null);\n  const markersRef = useRef([]);\n  useEffect(() => {\n    // Always initialize Leaflet for the map panel\n    try {\n      const map = L.map(mapContainer.current, {\n        scrollWheelZoom: true\n      }).setView([20, 0], 2);\n      L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {\n        maxZoom: 19,\n        attribution: '&copy; <a href=\"https://www.openstreetmap.org/\">OpenStreetMap</a> contributors'\n      }).addTo(map);\n      mapRef.current = map;\n\n      // ensure proper sizing when inside flex containers\n      const ensureSize = () => {\n        try {\n          map.invalidateSize && map.invalidateSize();\n        } catch (e) {}\n      };\n      ensureSize();\n      const _t1 = setTimeout(ensureSize, 100);\n      const _t2 = setTimeout(ensureSize, 500);\n      const _t3 = setTimeout(ensureSize, 1000);\n      const onResize = () => ensureSize();\n      window.addEventListener('resize', onResize);\n\n      // debug\n      // eslint-disable-next-line no-console\n      console.log('Leaflet initialized — scheduled invalidateSize retries');\n      return () => {\n        try {\n          window.removeEventListener('resize', onResize);\n        } catch (e) {}\n        clearTimeout(_t1);\n        clearTimeout(_t2);\n        clearTimeout(_t3);\n        try {\n          map.remove();\n        } catch (e) {}\n        mapRef.current = null;\n      };\n    } catch (e) {\n      // eslint-disable-next-line no-console\n      console.warn('Leaflet init failed:', e);\n      return undefined;\n    }\n  }, []);\n\n  // Update markers (Leaflet)\n  useEffect(() => {\n    const map = mapRef.current;\n    if (!map) return;\n\n    // remove existing marker layers\n    markersRef.current.forEach(m => {\n      try {\n        map.removeLayer(m);\n      } catch (e) {}\n    });\n    markersRef.current = [];\n    locations.forEach(loc => {\n      try {\n        const m = L.circleMarker([loc.coordinates[1], loc.coordinates[0]], {\n          radius: 6,\n          color: '#2a9df4',\n          fillOpacity: 0.9\n        }).addTo(map);\n        m.bindPopup(`<strong>${loc.title}</strong><br/>${loc.description}`);\n        markersRef.current.push(m);\n      } catch (e) {\n        // ignore\n      }\n    });\n  }, [locations]);\n\n  // Handle selection: open popup and set view\n  useEffect(() => {\n    if (!selectedLocation) return;\n    const map = mapRef.current;\n    if (!map) return;\n    const [lng, lat] = selectedLocation.coordinates;\n    map.setView([lat, lng], 14);\n    const matched = markersRef.current.find(m => {\n      try {\n        const latlng = m.getLatLng();\n        return Math.abs(latlng.lng - lng) < 1e-6 && Math.abs(latlng.lat - lat) < 1e-6;\n      } catch (e) {\n        return false;\n      }\n    });\n    if (matched && matched.openPopup) matched.openPopup();\n  }, [selectedLocation]);\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    style: {\n      position: 'relative',\n      height: '100%'\n    },\n    children: /*#__PURE__*/_jsxDEV(\"div\", {\n      ref: mapContainer,\n      id: \"map\",\n      className: \"map\",\n      style: {\n        height: '100%'\n      }\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 84,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 83,\n    columnNumber: 5\n  }, this);\n}\n_s(Map, \"0QljtO8RzWhlkrJOIuZ6SHs7slk=\");\n_c = Map;\nvar _c;\n$RefreshReg$(_c, \"Map\");","map":{"version":3,"names":["React","useRef","useEffect","L","jsxDEV","_jsxDEV","Map","locations","selectedLocation","_s","mapContainer","mapRef","markersRef","map","current","scrollWheelZoom","setView","tileLayer","maxZoom","attribution","addTo","ensureSize","invalidateSize","e","_t1","setTimeout","_t2","_t3","onResize","window","addEventListener","console","log","removeEventListener","clearTimeout","remove","warn","undefined","forEach","m","removeLayer","loc","circleMarker","coordinates","radius","color","fillOpacity","bindPopup","title","description","push","lng","lat","matched","find","latlng","getLatLng","Math","abs","openPopup","style","position","height","children","ref","id","className","fileName","_jsxFileName","lineNumber","columnNumber","_c","$RefreshReg$"],"sources":["/Users/noushinhaque/foodies/src/components/Map.js"],"sourcesContent":["import React, { useRef, useEffect } from 'react';\nimport L from 'leaflet';\nimport 'leaflet/dist/leaflet.css';\n\n// (No dynamic loaders needed — Leaflet is imported from npm)\n\nexport default function Map({ locations = [], selectedLocation = null }) {\n  const mapContainer = useRef(null);\n  const mapRef = useRef(null);\n  const markersRef = useRef([]);\n\n  useEffect(() => {\n    // Always initialize Leaflet for the map panel\n    try {\n      const map = L.map(mapContainer.current, { scrollWheelZoom: true }).setView([20, 0], 2);\n      L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {\n        maxZoom: 19,\n        attribution: '&copy; <a href=\"https://www.openstreetmap.org/\">OpenStreetMap</a> contributors',\n      }).addTo(map);\n\n      mapRef.current = map;\n\n      // ensure proper sizing when inside flex containers\n      const ensureSize = () => { try { map.invalidateSize && map.invalidateSize(); } catch (e) {} };\n      ensureSize();\n      const _t1 = setTimeout(ensureSize, 100);\n      const _t2 = setTimeout(ensureSize, 500);\n      const _t3 = setTimeout(ensureSize, 1000);\n      const onResize = () => ensureSize();\n      window.addEventListener('resize', onResize);\n\n      // debug\n      // eslint-disable-next-line no-console\n      console.log('Leaflet initialized — scheduled invalidateSize retries');\n\n      return () => {\n        try { window.removeEventListener('resize', onResize); } catch(e){}\n        clearTimeout(_t1); clearTimeout(_t2); clearTimeout(_t3);\n        try{ map.remove(); }catch(e){}\n        mapRef.current = null;\n      };\n    } catch (e) {\n      // eslint-disable-next-line no-console\n      console.warn('Leaflet init failed:', e);\n      return undefined;\n    }\n  }, []);\n\n  // Update markers (Leaflet)\n  useEffect(() => {\n    const map = mapRef.current;\n    if (!map) return;\n\n    // remove existing marker layers\n    markersRef.current.forEach((m) => { try { map.removeLayer(m); } catch(e) {} });\n    markersRef.current = [];\n\n    locations.forEach((loc) => {\n      try {\n        const m = L.circleMarker([loc.coordinates[1], loc.coordinates[0]], { radius: 6, color: '#2a9df4', fillOpacity: 0.9 }).addTo(map);\n        m.bindPopup(`<strong>${loc.title}</strong><br/>${loc.description}`);\n        markersRef.current.push(m);\n      } catch (e) {\n        // ignore\n      }\n    });\n  }, [locations]);\n\n  // Handle selection: open popup and set view\n  useEffect(() => {\n    if (!selectedLocation) return;\n    const map = mapRef.current;\n    if (!map) return;\n    const [lng, lat] = selectedLocation.coordinates;\n    map.setView([lat, lng], 14);\n    const matched = markersRef.current.find((m) => {\n      try { const latlng = m.getLatLng(); return Math.abs(latlng.lng - lng) < 1e-6 && Math.abs(latlng.lat - lat) < 1e-6; } catch(e) { return false; }\n    });\n    if (matched && matched.openPopup) matched.openPopup();\n  }, [selectedLocation]);\n\n  return (\n    <div style={{ position: 'relative', height: '100%' }}>\n      <div ref={mapContainer} id=\"map\" className=\"map\" style={{ height: '100%' }} />\n    </div>\n  );\n}\n"],"mappings":";;AAAA,OAAOA,KAAK,IAAIC,MAAM,EAAEC,SAAS,QAAQ,OAAO;AAChD,OAAOC,CAAC,MAAM,SAAS;AACvB,OAAO,0BAA0B;;AAEjC;AAAA,SAAAC,MAAA,IAAAC,OAAA;AAEA,eAAe,SAASC,GAAGA,CAAC;EAAEC,SAAS,GAAG,EAAE;EAAEC,gBAAgB,GAAG;AAAK,CAAC,EAAE;EAAAC,EAAA;EACvE,MAAMC,YAAY,GAAGT,MAAM,CAAC,IAAI,CAAC;EACjC,MAAMU,MAAM,GAAGV,MAAM,CAAC,IAAI,CAAC;EAC3B,MAAMW,UAAU,GAAGX,MAAM,CAAC,EAAE,CAAC;EAE7BC,SAAS,CAAC,MAAM;IACd;IACA,IAAI;MACF,MAAMW,GAAG,GAAGV,CAAC,CAACU,GAAG,CAACH,YAAY,CAACI,OAAO,EAAE;QAAEC,eAAe,EAAE;MAAK,CAAC,CAAC,CAACC,OAAO,CAAC,CAAC,EAAE,EAAE,CAAC,CAAC,EAAE,CAAC,CAAC;MACtFb,CAAC,CAACc,SAAS,CAAC,oDAAoD,EAAE;QAChEC,OAAO,EAAE,EAAE;QACXC,WAAW,EAAE;MACf,CAAC,CAAC,CAACC,KAAK,CAACP,GAAG,CAAC;MAEbF,MAAM,CAACG,OAAO,GAAGD,GAAG;;MAEpB;MACA,MAAMQ,UAAU,GAAGA,CAAA,KAAM;QAAE,IAAI;UAAER,GAAG,CAACS,cAAc,IAAIT,GAAG,CAACS,cAAc,CAAC,CAAC;QAAE,CAAC,CAAC,OAAOC,CAAC,EAAE,CAAC;MAAE,CAAC;MAC7FF,UAAU,CAAC,CAAC;MACZ,MAAMG,GAAG,GAAGC,UAAU,CAACJ,UAAU,EAAE,GAAG,CAAC;MACvC,MAAMK,GAAG,GAAGD,UAAU,CAACJ,UAAU,EAAE,GAAG,CAAC;MACvC,MAAMM,GAAG,GAAGF,UAAU,CAACJ,UAAU,EAAE,IAAI,CAAC;MACxC,MAAMO,QAAQ,GAAGA,CAAA,KAAMP,UAAU,CAAC,CAAC;MACnCQ,MAAM,CAACC,gBAAgB,CAAC,QAAQ,EAAEF,QAAQ,CAAC;;MAE3C;MACA;MACAG,OAAO,CAACC,GAAG,CAAC,wDAAwD,CAAC;MAErE,OAAO,MAAM;QACX,IAAI;UAAEH,MAAM,CAACI,mBAAmB,CAAC,QAAQ,EAAEL,QAAQ,CAAC;QAAE,CAAC,CAAC,OAAML,CAAC,EAAC,CAAC;QACjEW,YAAY,CAACV,GAAG,CAAC;QAAEU,YAAY,CAACR,GAAG,CAAC;QAAEQ,YAAY,CAACP,GAAG,CAAC;QACvD,IAAG;UAAEd,GAAG,CAACsB,MAAM,CAAC,CAAC;QAAE,CAAC,QAAMZ,CAAC,EAAC,CAAC;QAC7BZ,MAAM,CAACG,OAAO,GAAG,IAAI;MACvB,CAAC;IACH,CAAC,CAAC,OAAOS,CAAC,EAAE;MACV;MACAQ,OAAO,CAACK,IAAI,CAAC,sBAAsB,EAAEb,CAAC,CAAC;MACvC,OAAOc,SAAS;IAClB;EACF,CAAC,EAAE,EAAE,CAAC;;EAEN;EACAnC,SAAS,CAAC,MAAM;IACd,MAAMW,GAAG,GAAGF,MAAM,CAACG,OAAO;IAC1B,IAAI,CAACD,GAAG,EAAE;;IAEV;IACAD,UAAU,CAACE,OAAO,CAACwB,OAAO,CAAEC,CAAC,IAAK;MAAE,IAAI;QAAE1B,GAAG,CAAC2B,WAAW,CAACD,CAAC,CAAC;MAAE,CAAC,CAAC,OAAMhB,CAAC,EAAE,CAAC;IAAE,CAAC,CAAC;IAC9EX,UAAU,CAACE,OAAO,GAAG,EAAE;IAEvBP,SAAS,CAAC+B,OAAO,CAAEG,GAAG,IAAK;MACzB,IAAI;QACF,MAAMF,CAAC,GAAGpC,CAAC,CAACuC,YAAY,CAAC,CAACD,GAAG,CAACE,WAAW,CAAC,CAAC,CAAC,EAAEF,GAAG,CAACE,WAAW,CAAC,CAAC,CAAC,CAAC,EAAE;UAAEC,MAAM,EAAE,CAAC;UAAEC,KAAK,EAAE,SAAS;UAAEC,WAAW,EAAE;QAAI,CAAC,CAAC,CAAC1B,KAAK,CAACP,GAAG,CAAC;QAChI0B,CAAC,CAACQ,SAAS,CAAC,WAAWN,GAAG,CAACO,KAAK,iBAAiBP,GAAG,CAACQ,WAAW,EAAE,CAAC;QACnErC,UAAU,CAACE,OAAO,CAACoC,IAAI,CAACX,CAAC,CAAC;MAC5B,CAAC,CAAC,OAAOhB,CAAC,EAAE;QACV;MAAA;IAEJ,CAAC,CAAC;EACJ,CAAC,EAAE,CAAChB,SAAS,CAAC,CAAC;;EAEf;EACAL,SAAS,CAAC,MAAM;IACd,IAAI,CAACM,gBAAgB,EAAE;IACvB,MAAMK,GAAG,GAAGF,MAAM,CAACG,OAAO;IAC1B,IAAI,CAACD,GAAG,EAAE;IACV,MAAM,CAACsC,GAAG,EAAEC,GAAG,CAAC,GAAG5C,gBAAgB,CAACmC,WAAW;IAC/C9B,GAAG,CAACG,OAAO,CAAC,CAACoC,GAAG,EAAED,GAAG,CAAC,EAAE,EAAE,CAAC;IAC3B,MAAME,OAAO,GAAGzC,UAAU,CAACE,OAAO,CAACwC,IAAI,CAAEf,CAAC,IAAK;MAC7C,IAAI;QAAE,MAAMgB,MAAM,GAAGhB,CAAC,CAACiB,SAAS,CAAC,CAAC;QAAE,OAAOC,IAAI,CAACC,GAAG,CAACH,MAAM,CAACJ,GAAG,GAAGA,GAAG,CAAC,GAAG,IAAI,IAAIM,IAAI,CAACC,GAAG,CAACH,MAAM,CAACH,GAAG,GAAGA,GAAG,CAAC,GAAG,IAAI;MAAE,CAAC,CAAC,OAAM7B,CAAC,EAAE;QAAE,OAAO,KAAK;MAAE;IAChJ,CAAC,CAAC;IACF,IAAI8B,OAAO,IAAIA,OAAO,CAACM,SAAS,EAAEN,OAAO,CAACM,SAAS,CAAC,CAAC;EACvD,CAAC,EAAE,CAACnD,gBAAgB,CAAC,CAAC;EAEtB,oBACEH,OAAA;IAAKuD,KAAK,EAAE;MAAEC,QAAQ,EAAE,UAAU;MAAEC,MAAM,EAAE;IAAO,CAAE;IAAAC,QAAA,eACnD1D,OAAA;MAAK2D,GAAG,EAAEtD,YAAa;MAACuD,EAAE,EAAC,KAAK;MAACC,SAAS,EAAC,KAAK;MAACN,KAAK,EAAE;QAAEE,MAAM,EAAE;MAAO;IAAE;MAAAK,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OAAE;EAAC;IAAAH,QAAA,EAAAC,YAAA;IAAAC,UAAA;IAAAC,YAAA;EAAA,OAC3E,CAAC;AAEV;AAAC7D,EAAA,CAhFuBH,GAAG;AAAAiE,EAAA,GAAHjE,GAAG;AAAA,IAAAiE,EAAA;AAAAC,YAAA,CAAAD,EAAA","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}